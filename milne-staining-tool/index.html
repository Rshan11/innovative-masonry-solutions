<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Innovative Masonry Solutions - Staining Estimate</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --brick: #8B4513;
            --brick-dark: #5D2E0C;
            --brick-light: #A0522D;
            --mortar: #D4C4B0;
            --cream: #FAF6F1;
            --charcoal: #2D2D2D;
            --slate: #4A5568;
            --gold: #C9A227;
            --gold-light: #E8D48B;
            --success: #48BB78;
            --white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--charcoal);
            color: var(--charcoal);
            min-height: 100vh;
        }

        /* Brick pattern background */
        .brick-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(135deg, rgba(139,69,19,0.03) 25%, transparent 25%),
                linear-gradient(225deg, rgba(139,69,19,0.03) 25%, transparent 25%),
                linear-gradient(45deg, rgba(139,69,19,0.03) 25%, transparent 25%),
                linear-gradient(315deg, rgba(139,69,19,0.03) 25%, transparent 25%),
                var(--cream);
            background-size: 60px 60px;
            background-position: 0 0, 30px 0, 30px -30px, 0 30px;
            z-index: -1;
        }

        .app-container {
            display: grid;
            grid-template-columns: minmax(400px, 500px) 1fr;
            min-height: 100vh;
        }

        @media (max-width: 1100px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            .preview-panel {
                display: none;
            }
            .calculator-panel {
                max-height: none;
            }
        }

        /* Left Panel - Calculator */
        .calculator-panel {
            background: var(--white);
            box-shadow: 8px 0 40px rgba(0,0,0,0.15);
            overflow-y: auto;
            max-height: 100vh;
            position: relative;
            z-index: 10;
        }

        .panel-header {
            background: linear-gradient(135deg, var(--brick-dark) 0%, var(--brick) 50%, var(--brick-light) 100%);
            padding: 1.75rem 2rem;
            position: relative;
            overflow: hidden;
        }

        .panel-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
        }

        .logo-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            z-index: 1;
        }

        .logo-mark {
            width: 56px;
            height: 56px;
            background: var(--white);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .logo-mark svg {
            width: 36px;
            height: 36px;
            fill: var(--brick-dark);
        }

        .logo-text h1 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--white);
            letter-spacing: -0.02em;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .logo-text span {
            font-size: 0.75rem;
            color: var(--gold-light);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-weight: 500;
        }

        .panel-body {
            padding: 1.5rem 2rem 2rem;
        }

        .section {
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--brick);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 4px;
            background: var(--gold);
            border-radius: 50%;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, var(--mortar) 0%, transparent 100%);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--slate);
        }

        input, select, textarea {
            padding: 0.65rem 0.85rem;
            border: 2px solid var(--mortar);
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.2s;
            background: var(--white);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--brick);
            box-shadow: 0 0 0 4px rgba(139,69,19,0.1);
        }

        input:hover, select:hover {
            border-color: var(--brick-light);
        }

        input[type="number"] {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }

        .input-with-prefix {
            position: relative;
        }

        .input-with-prefix input {
            padding-left: 1.75rem;
        }

        .input-with-prefix::before {
            content: '$';
            position: absolute;
            left: 0.85rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--slate);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }

        /* Areas Table */
        .areas-container {
            background: var(--cream);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 0.5rem;
        }

        .areas-table {
            width: 100%;
            border-collapse: collapse;
        }

        .areas-table th {
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--brick);
            text-align: left;
            padding: 0.5rem 0.35rem;
        }

        .areas-table td {
            padding: 0.3rem;
        }

        .areas-table input, .areas-table select {
            width: 100%;
            padding: 0.5rem 0.6rem;
            font-size: 0.8rem;
            border-width: 1px;
        }

        .calculated-field {
            background: var(--white) !important;
            border-color: transparent !important;
            color: var(--brick-dark);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            text-align: center;
        }

        .add-area-btn {
            margin-top: 0.75rem;
            padding: 0.6rem 1rem;
            background: transparent;
            border: 2px dashed var(--mortar);
            border-radius: 8px;
            color: var(--slate);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
        }

        .add-area-btn:hover {
            background: var(--white);
            border-color: var(--brick);
            color: var(--brick);
        }

        /* Totals */
        .totals-box {
            background: linear-gradient(135deg, var(--charcoal) 0%, #3D3D3D 100%);
            color: var(--white);
            padding: 1.5rem;
            border-radius: 16px;
            margin-top: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .totals-box::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(201,162,39,0.15) 0%, transparent 70%);
        }

        .totals-row {
            display: flex;
            justify-content: space-between;
            padding: 0.4rem 0;
            font-size: 0.9rem;
            position: relative;
            z-index: 1;
        }

        .totals-row .label {
            color: rgba(255,255,255,0.7);
        }

        .totals-row .value {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }

        .totals-row.subtotal {
            border-top: 1px solid rgba(255,255,255,0.15);
            margin-top: 0.5rem;
            padding-top: 0.75rem;
        }

        .totals-row.grand-total {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 0.75rem;
            padding-top: 1rem;
            border-top: 2px solid var(--gold);
        }

        .totals-row.grand-total .label {
            color: var(--white);
        }

        .totals-row.grand-total .value {
            color: var(--gold-light);
        }

        .per-sf {
            font-size: 0.8rem;
            color: var(--gold);
            text-align: right;
            margin-top: 0.75rem;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Settings Toggle */
        .settings-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.6rem;
            background: var(--cream);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--slate);
            margin-bottom: 1.25rem;
            transition: all 0.2s;
            width: 100%;
        }

        .settings-toggle:hover {
            background: var(--mortar);
            color: var(--brick-dark);
        }

        .settings-toggle svg {
            width: 16px;
            height: 16px;
            transition: transform 0.3s;
        }

        .settings-toggle.open svg {
            transform: rotate(90deg);
        }

        .settings-panel {
            display: none;
            padding: 1.25rem;
            background: var(--cream);
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .settings-panel.open {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.6rem;
        }

        .settings-grid .form-group {
            gap: 0.2rem;
        }

        .settings-grid label {
            font-size: 0.65rem;
        }

        .settings-grid input {
            font-size: 0.8rem;
            padding: 0.5rem;
        }

        .settings-section-title {
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--brick);
            margin: 1rem 0 0.5rem;
        }

        .settings-section-title:first-child {
            margin-top: 0;
        }

        /* Right Panel - Quote Preview */
        .preview-panel {
            padding: 2.5rem;
            overflow-y: auto;
            max-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .preview-actions {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            width: 100%;
            max-width: 8in;
        }

        .btn {
            padding: 0.85rem 1.75rem;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn svg {
            width: 18px;
            height: 18px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--brick) 0%, var(--brick-dark) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(139,69,19,0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139,69,19,0.4);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--charcoal);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .btn-secondary:hover {
            background: var(--cream);
        }

        /* Quote Document */
        .quote-document {
            background: var(--white);
            padding: 2.5rem;
            border-radius: 8px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.25);
            width: 100%;
            max-width: 8in;
        }

        .quote-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-bottom: 1.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 3px solid var(--brick);
        }

        .quote-company h2 {
            font-size: 1.6rem;
            color: var(--brick-dark);
            font-weight: 800;
            letter-spacing: -0.02em;
        }

        .quote-company .tagline {
            font-size: 0.85rem;
            color: var(--slate);
            font-style: italic;
            margin-top: 0.1rem;
        }

        .quote-company .address {
            font-size: 0.8rem;
            color: var(--slate);
            margin-top: 0.75rem;
            line-height: 1.6;
        }

        .quote-title-block {
            text-align: right;
        }

        .quote-title-block h3 {
            font-size: 1.1rem;
            color: var(--brick);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 700;
        }

        .quote-title-block .licenses {
            font-size: 0.7rem;
            color: var(--slate);
            margin-top: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .quote-info-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 0.3rem 1.25rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
        }

        .quote-info-grid dt {
            font-weight: 600;
            color: var(--slate);
        }

        .quote-info-grid dd {
            color: var(--charcoal);
        }

        .quote-section-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--brick);
            margin: 1.75rem 0 0.75rem;
            padding-bottom: 0.35rem;
            border-bottom: 2px solid var(--mortar);
        }

        .pricing-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        .pricing-table th {
            background: var(--brick-dark);
            color: white;
            padding: 0.75rem 1rem;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .pricing-table th:last-child {
            text-align: right;
        }

        .pricing-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--mortar);
            font-size: 0.9rem;
        }

        .pricing-table td:last-child {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }

        .pricing-table tr.total-row {
            background: var(--cream);
        }

        .pricing-table tr.total-row td {
            font-weight: 700;
            border-bottom: none;
            color: var(--brick-dark);
        }

        .scope-list {
            list-style: none;
            font-size: 0.9rem;
        }

        .scope-list li {
            padding: 0.4rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .scope-list li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.7rem;
            width: 6px;
            height: 6px;
            background: var(--gold);
            border-radius: 50%;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .terms-text {
            font-size: 0.85rem;
            color: var(--slate);
            line-height: 1.8;
        }

        .terms-text p {
            margin-bottom: 0.5rem;
        }

        .referral-box {
            background: linear-gradient(135deg, var(--cream) 0%, #F5EDE0 100%);
            border-left: 4px solid var(--gold);
            padding: 1rem 1.25rem;
            margin-top: 1.25rem;
            font-size: 0.85rem;
            border-radius: 0 8px 8px 0;
        }

        .referral-box strong {
            color: var(--brick-dark);
        }

        .signature-block {
            margin-top: 2.5rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2.5rem;
        }

        .sig-line {
            border-top: 1px solid var(--slate);
            padding-top: 0.4rem;
            font-size: 0.75rem;
            color: var(--slate);
            margin-top: 2.5rem;
        }

        .quote-footer {
            margin-top: 2.5rem;
            padding-top: 1.25rem;
            border-top: 2px solid var(--mortar);
            text-align: center;
            font-size: 0.8rem;
            color: var(--slate);
        }

        .quote-footer strong {
            color: var(--brick-dark);
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
            }
            .brick-bg {
                display: none;
            }
            .calculator-panel, .preview-actions {
                display: none !important;
            }
            .app-container {
                display: block;
            }
            .preview-panel {
                background: white;
                padding: 0;
                max-height: none;
            }
            .quote-document {
                box-shadow: none;
                padding: 0.5in;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="brick-bg"></div>
    <div class="app-container">
        <!-- Calculator Panel -->
        <div class="calculator-panel">
            <div class="panel-header">
                <div class="logo-row">
                    <div class="logo-mark">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 4h7v5H3V4zm11 0h7v5h-7V4zM3 11h7v5H3v-5zm11 0h7v5h-7v-5zM3 18h7v2H3v-2zm11 0h7v2h-7v-2z"/>
                        </svg>
                    </div>
                    <div class="logo-text">
                        <h1>Innovative Masonry Solutions</h1>
                        <span>Staining Estimate Tool</span>
                    </div>
                </div>
            </div>

            <div class="panel-body">
                <!-- Settings Toggle -->
                <button class="settings-toggle" id="settingsToggle" onclick="toggleSettings()">
                    <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M12 15a3 3 0 100-6 3 3 0 000 6z"/>
                        <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                    </svg>
                    Settings — Labor, Materials, Production Rates
                </button>

                <div class="settings-panel" id="settingsPanel">
                    <div class="settings-section-title">Labor & Markup</div>
                    <div class="settings-grid">
                        <div class="form-group">
                            <label>Daily Rate/Person</label>
                            <input type="number" id="dailyRate" value="560" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Setup/Cleanup $/hr</label>
                            <input type="number" id="setupRate" value="70" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Markup %</label>
                            <input type="number" id="markup" value="30" onchange="calculate()">
                        </div>
                    </div>

                    <div class="settings-section-title">Production (SF/person/day)</div>
                    <div class="settings-grid">
                        <div class="form-group">
                            <label>Easy - Open</label>
                            <input type="number" id="prodEasy" value="300" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Medium - Mixed</label>
                            <input type="number" id="prodMedium" value="200" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Detail - Columns</label>
                            <input type="number" id="prodDetail" value="100" onchange="calculate()">
                        </div>
                    </div>

                    <div class="settings-section-title">Materials</div>
                    <div class="settings-grid">
                        <div class="form-group">
                            <label>Elixir $/gal</label>
                            <input type="number" id="elixirCost" value="45.32" step="0.01" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Color Tub $</label>
                            <input type="number" id="colorCost" value="245.14" step="0.01" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Half cups/gal</label>
                            <input type="number" id="cupsPerGal" value="32.5" step="0.1" onchange="calculate()">
                        </div>
                    </div>
                </div>

                <!-- Job Info -->
                <div class="section">
                    <div class="section-title">Job Information</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" id="quoteDate" onchange="updatePreview()">
                        </div>
                        <div class="form-group">
                            <label>Estimator</label>
                            <input type="text" id="estimator" value="Ryan Shanley 503.490.2136" onchange="updatePreview()">
                        </div>
                        <div class="form-group full-width">
                            <label>Project Name</label>
                            <input type="text" id="projectName" placeholder="e.g., Nelson Family House" onchange="updatePreview()">
                        </div>
                        <div class="form-group full-width">
                            <label>Address</label>
                            <input type="text" id="address" placeholder="Street address" onchange="updatePreview()">
                        </div>
                        <div class="form-group full-width">
                            <label>City, State, Zip</label>
                            <input type="text" id="cityStateZip" placeholder="e.g., Keizer, OR 97303" onchange="updatePreview()">
                        </div>
                        <div class="form-group full-width">
                            <label>Contact Name</label>
                            <input type="text" id="contact" placeholder="Customer name" onchange="updatePreview()">
                        </div>
                    </div>
                </div>

                <!-- Sample Panel -->
                <div class="section">
                    <div class="section-title">Sample Panel</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Sample Panel Price</label>
                            <div class="input-with-prefix">
                                <input type="number" id="samplePanel" value="500" onchange="calculate()">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes (travel, etc.)</label>
                            <input type="text" id="sampleNotes" placeholder="Optional">
                        </div>
                    </div>
                </div>

                <!-- Brick & Crew -->
                <div class="section">
                    <div class="section-title">Brick Type & Crew</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Brick Type</label>
                            <select id="brickType" onchange="calculate()">
                                <option value="standards" data-persf="6.5" data-percup="80">Standards (6.5/SF)</option>
                                <option value="225standards" data-persf="5.5" data-percup="92">2.25 Standards (5.5/SF)</option>
                                <option value="normans" data-persf="4.5" data-percup="53">Normans (4.5/SF)</option>
                                <option value="romans" data-persf="3.5" data-percup="45">Romans (3.5/SF)</option>
                                <option value="econs" data-persf="4" data-percup="42">Econs (4/SF)</option>
                                <option value="448s" data-persf="5" data-percup="63">448s (5/SF)</option>
                                <option value="cmu" data-persf="1.125" data-percup="20">CMU 8" (1.125/SF)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Crew Size</label>
                            <select id="crewSize" onchange="calculate()">
                                <option value="1">1 person</option>
                                <option value="2">2 people</option>
                                <option value="3">3 people</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Work Areas -->
                <div class="section">
                    <div class="section-title">Work Areas</div>
                    <div class="areas-container">
                        <table class="areas-table">
                            <thead>
                                <tr>
                                    <th style="width:28%">Description</th>
                                    <th style="width:12%">Length</th>
                                    <th style="width:12%">Height</th>
                                    <th style="width:12%">SF</th>
                                    <th style="width:22%">Difficulty</th>
                                    <th style="width:14%">Days</th>
                                </tr>
                            </thead>
                            <tbody id="areasBody">
                                <tr>
                                    <td><input type="text" placeholder="e.g., Front wall" onchange="calculate()"></td>
                                    <td><input type="number" placeholder="0" onchange="calculate()"></td>
                                    <td><input type="number" placeholder="0" onchange="calculate()"></td>
                                    <td><input type="number" class="calculated-field" readonly></td>
                                    <td>
                                        <select onchange="calculate()">
                                            <option value="easy">Easy</option>
                                            <option value="medium">Medium</option>
                                            <option value="detail">Detail</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="calculated-field" readonly></td>
                                </tr>
                            </tbody>
                        </table>
                        <button class="add-area-btn" onclick="addArea()">+ Add Another Area</button>
                    </div>
                </div>

                <!-- Setup & Subs -->
                <div class="section">
                    <div class="section-title">Setup & Subcontractors</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Setup Hours</label>
                            <input type="number" id="setupHours" value="2" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Cleanup Hours</label>
                            <input type="number" id="cleanupHours" value="2" onchange="calculate()">
                        </div>
                        <div class="form-group">
                            <label>Pressure Wash (sub)</label>
                            <div class="input-with-prefix">
                                <input type="number" id="pressureWash" value="0" onchange="calculate()">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Other Sub</label>
                            <div class="input-with-prefix">
                                <input type="number" id="otherSub" value="0" onchange="calculate()">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Totals -->
                <div class="totals-box">
                    <div class="totals-row">
                        <span class="label">Labor</span>
                        <span class="value" id="totalLabor">$0</span>
                    </div>
                    <div class="totals-row">
                        <span class="label">Materials</span>
                        <span class="value" id="totalMaterials">$0</span>
                    </div>
                    <div class="totals-row">
                        <span class="label">Setup/Cleanup</span>
                        <span class="value" id="totalSetup">$0</span>
                    </div>
                    <div class="totals-row">
                        <span class="label">Subcontractors</span>
                        <span class="value" id="totalSubs">$0</span>
                    </div>
                    <div class="totals-row subtotal">
                        <span class="label">Subtotal</span>
                        <span class="value" id="subtotal">$0</span>
                    </div>
                    <div class="totals-row">
                        <span class="label">Markup (<span id="markupPct">30</span>%)</span>
                        <span class="value" id="totalMarkup">$0</span>
                    </div>
                    <div class="totals-row grand-total">
                        <span class="label">Staining Total</span>
                        <span class="value" id="stainingTotal">$0</span>
                    </div>
                    <div class="totals-row" style="opacity: 0.6; font-size: 0.85rem;">
                        <span class="label">+ Sample Panel</span>
                        <span class="value" id="samplePanelTotal">$500</span>
                    </div>
                    <div class="totals-row grand-total" style="border-top-color: rgba(255,255,255,0.3); margin-top: 0.5rem;">
                        <span class="label">GRAND TOTAL</span>
                        <span class="value" id="grandTotal">$500</span>
                    </div>
                    <div class="per-sf">
                        <span id="totalSF">0</span> SF @ <span id="perSF">$0.00</span>/SF
                    </div>
                </div>
            </div>
        </div>

        <!-- Preview Panel -->
        <div class="preview-panel">
            <div class="preview-actions">
                <button class="btn btn-primary" onclick="window.print()">
                    <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                    </svg>
                    Print / Save PDF
                </button>
                <button class="btn btn-secondary" onclick="copyToClipboard()">
                    <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                    </svg>
                    Copy Text
                </button>
            </div>

            <div class="quote-document" id="quoteDocument">
                <div class="quote-header">
                    <div class="quote-company">
                        <h2>INNOVATIVE MASONRY SOLUTIONS</h2>
                        <div class="tagline">DBA Milne Masonry, Inc.</div>
                        <div class="address">
                            14489 SE Hwy 212<br>
                            Clackamas, OR 97015<br>
                            (503) 658-6444
                        </div>
                    </div>
                    <div class="quote-title-block">
                        <h3>Masonry Staining<br>Proposal</h3>
                        <div class="licenses">
                            OR CCB# 120098<br>
                            WA# MILNEMI032J5
                        </div>
                    </div>
                </div>

                <dl class="quote-info-grid">
                    <dt>Date:</dt>
                    <dd id="previewDate">—</dd>
                    <dt>Project:</dt>
                    <dd id="previewProject">—</dd>
                    <dt>Address:</dt>
                    <dd id="previewAddress">—</dd>
                    <dt>Prepared for:</dt>
                    <dd id="previewContact">—</dd>
                    <dt>Estimator:</dt>
                    <dd id="previewEstimator">Ryan Shanley 503.490.2136</dd>
                </dl>

                <div class="quote-section-title">Proposal</div>
                <table class="pricing-table">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th style="text-align: right;">Price</th>
                        </tr>
                    </thead>
                    <tbody id="previewPricing">
                        <tr>
                            <td>Sample Panel</td>
                            <td>$500</td>
                        </tr>
                        <tr>
                            <td>Brick Staining — <span id="previewSF">0</span> SF</td>
                            <td id="previewStaining">$0</td>
                        </tr>
                        <tr class="total-row">
                            <td>TOTAL</td>
                            <td id="previewTotal">$500</td>
                        </tr>
                    </tbody>
                </table>

                <div class="quote-section-title">Scope of Work</div>
                <ul class="scope-list">
                    <li>Sample panel; if accepted on first trip, included in staining price.</li>
                    <li>Stain brick to specified color per approved sample.</li>
                    <li>For best results, brick should be pressure washed prior to our arrival.</li>
                    <li>Final walkthrough with photos and care tips.</li>
                </ul>

                <div class="two-column">
                    <div>
                        <div class="quote-section-title">Inclusions</div>
                        <ul class="scope-list">
                            <li>Access equipment as needed</li>
                            <li>Daily cleanup</li>
                            <li>1 mobilization included</li>
                        </ul>
                    </div>
                    <div>
                        <div class="quote-section-title">Exclusions</div>
                        <ul class="scope-list">
                            <li>Pressure washing</li>
                            <li>Masonry repairs</li>
                            <li>Permits / Traffic control</li>
                        </ul>
                    </div>
                </div>

                <div class="quote-section-title">Terms</div>
                <div class="terms-text">
                    <p>This bid is valid for 30 days from the date above.</p>
                    <p>30% deposit to schedule sample panel; balance due at completion after walkthrough.</p>
                    <p>Additional mobilizations: $500 each. Card accepted; +2% processing fee.</p>
                </div>

                <div class="referral-box">
                    <strong>Neighbor Referral:</strong> For each neighbor who books within 60 days and mentions you, we'll apply 5% off your final invoice (up to 15% max).
                </div>

                <div class="signature-block">
                    <div>
                        <div class="sig-line">Customer Signature</div>
                        <div class="sig-line">Print Name</div>
                    </div>
                    <div>
                        <div class="sig-line">Date</div>
                        <div class="sig-line">Phone</div>
                    </div>
                </div>

                <div class="quote-footer">
                    <strong>Innovative Masonry Solutions</strong> DBA Milne Masonry, Inc.<br>
                    Licensed • Bonded • Insured • Union Shop
                </div>
            </div>
        </div>
    </div>

    <script>
        // Set today's date
        document.getElementById('quoteDate').valueAsDate = new Date();

        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            const toggle = document.getElementById('settingsToggle');
            panel.classList.toggle('open');
            toggle.classList.toggle('open');
        }

        function addArea() {
            const tbody = document.getElementById('areasBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="text" placeholder="Description" onchange="calculate()"></td>
                <td><input type="number" placeholder="0" onchange="calculate()"></td>
                <td><input type="number" placeholder="0" onchange="calculate()"></td>
                <td><input type="number" class="calculated-field" readonly></td>
                <td>
                    <select onchange="calculate()">
                        <option value="easy">Easy</option>
                        <option value="medium">Medium</option>
                        <option value="detail">Detail</option>
                    </select>
                </td>
                <td><input type="text" class="calculated-field" readonly></td>
            `;
            tbody.appendChild(row);
        }

        function calculate() {
            // Get settings
            const dailyRate = parseFloat(document.getElementById('dailyRate').value) || 0;
            const setupRate = parseFloat(document.getElementById('setupRate').value) || 0;
            const markup = parseFloat(document.getElementById('markup').value) || 0;
            const prodRates = {
                easy: parseFloat(document.getElementById('prodEasy').value) || 300,
                medium: parseFloat(document.getElementById('prodMedium').value) || 200,
                detail: parseFloat(document.getElementById('prodDetail').value) || 100
            };
            const elixirCost = parseFloat(document.getElementById('elixirCost').value) || 0;
            const colorCost = parseFloat(document.getElementById('colorCost').value) || 0;
            const cupsPerGal = parseFloat(document.getElementById('cupsPerGal').value) || 32.5;

            const crewSize = parseInt(document.getElementById('crewSize').value) || 1;
            const brickSelect = document.getElementById('brickType');
            const brickPerSF = parseFloat(brickSelect.options[brickSelect.selectedIndex].dataset.persf) || 6.5;
            const brickPerCup = parseFloat(brickSelect.options[brickSelect.selectedIndex].dataset.percup) || 80;

            // Calculate areas
            const rows = document.getElementById('areasBody').querySelectorAll('tr');
            let totalSF = 0;
            let totalDays = 0;

            rows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                const select = row.querySelector('select');
                
                // inputs: 0=desc, 1=length, 2=height, 3=sf, 4=days
                const length = parseFloat(inputs[1].value) || 0;
                const height = parseFloat(inputs[2].value) || 0;
                const sf = length * height;
                inputs[3].value = sf > 0 ? sf : '';
                
                const difficulty = select.value;
                const prodRate = prodRates[difficulty];
                
                const days = sf > 0 ? sf / (prodRate * crewSize) : 0;
                inputs[4].value = days > 0 ? days.toFixed(2) : '';
                
                totalSF += sf;
                totalDays += days;
            });

            // Labor cost
            const laborCost = totalDays * crewSize * dailyRate;

            // Materials
            const brickCount = totalSF * brickPerSF;
            const halfCupsNeeded = brickCount / brickPerCup;
            const gallonsElixir = Math.ceil(halfCupsNeeded / cupsPerGal * 10) / 10;
            const tubsColor = Math.ceil((halfCupsNeeded * 1.5) / 72 * 10) / 10;
            const materialsCost = (gallonsElixir * elixirCost) + (tubsColor * colorCost);

            // Setup/Cleanup
            const setupHours = parseFloat(document.getElementById('setupHours').value) || 0;
            const cleanupHours = parseFloat(document.getElementById('cleanupHours').value) || 0;
            const setupCost = (setupHours + cleanupHours) * setupRate;

            // Subs
            const pressureWash = parseFloat(document.getElementById('pressureWash').value) || 0;
            const otherSub = parseFloat(document.getElementById('otherSub').value) || 0;
            const subsCost = pressureWash + otherSub;

            // Totals
            const subtotal = laborCost + materialsCost + setupCost + subsCost;
            const markupAmount = subtotal * (markup / 100);
            const stainingTotal = subtotal + markupAmount;
            const samplePanel = parseFloat(document.getElementById('samplePanel').value) || 0;
            const grandTotal = stainingTotal + samplePanel;
            const perSF = totalSF > 0 ? stainingTotal / totalSF : 0;

            // Update display
            document.getElementById('totalLabor').textContent = '$' + laborCost.toFixed(0);
            document.getElementById('totalMaterials').textContent = '$' + materialsCost.toFixed(0);
            document.getElementById('totalSetup').textContent = '$' + setupCost.toFixed(0);
            document.getElementById('totalSubs').textContent = '$' + subsCost.toFixed(0);
            document.getElementById('subtotal').textContent = '$' + subtotal.toFixed(0);
            document.getElementById('markupPct').textContent = markup;
            document.getElementById('totalMarkup').textContent = '$' + markupAmount.toFixed(0);
            document.getElementById('stainingTotal').textContent = '$' + stainingTotal.toFixed(0);
            document.getElementById('samplePanelTotal').textContent = '$' + samplePanel.toFixed(0);
            document.getElementById('grandTotal').textContent = '$' + grandTotal.toFixed(0);
            document.getElementById('totalSF').textContent = totalSF;
            document.getElementById('perSF').textContent = '$' + perSF.toFixed(2);

            // Update preview
            document.getElementById('previewSF').textContent = totalSF;
            document.getElementById('previewStaining').textContent = '$' + stainingTotal.toLocaleString('en-US', {maximumFractionDigits: 0});
            document.getElementById('previewTotal').textContent = '$' + grandTotal.toLocaleString('en-US', {maximumFractionDigits: 0});

            updatePreview();
        }

        function updatePreview() {
            const date = document.getElementById('quoteDate').value;
            const project = document.getElementById('projectName').value || '—';
            const address = document.getElementById('address').value;
            const cityStateZip = document.getElementById('cityStateZip').value;
            const contact = document.getElementById('contact').value || '—';
            const estimator = document.getElementById('estimator').value;

            document.getElementById('previewDate').textContent = date ? new Date(date + 'T12:00:00').toLocaleDateString() : '—';
            document.getElementById('previewProject').textContent = project;
            document.getElementById('previewAddress').textContent = address && cityStateZip ? address + ', ' + cityStateZip : (address || cityStateZip || '—');
            document.getElementById('previewContact').textContent = contact;
            document.getElementById('previewEstimator').textContent = estimator;

            // Update pricing table sample panel
            const samplePanel = parseFloat(document.getElementById('samplePanel').value) || 0;
            const pricingBody = document.getElementById('previewPricing');
            pricingBody.querySelector('tr:first-child td:last-child').textContent = '$' + samplePanel.toLocaleString('en-US', {maximumFractionDigits: 0});
        }

        function copyToClipboard() {
            const doc = document.getElementById('quoteDocument');
            const text = doc.innerText;
            navigator.clipboard.writeText(text).then(() => {
                alert('Quote text copied to clipboard');
            });
        }

        // Initial calculation
        calculate();
    </script>
</body>
</html>
